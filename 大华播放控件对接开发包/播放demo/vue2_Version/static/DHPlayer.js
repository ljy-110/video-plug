/*!
 * version: v1.0.202206201652
 * description: demo功能点优化
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DHPlayer",[],t):"object"==typeof exports?exports.DHPlayer=t():e.DHPlayer=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=1)}([function(e,t,n){"use strict";function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(o,s){try{var r=t[o](s),d=r.value}catch(e){return void n(e)}if(!r.done)return Promise.resolve(d).then(function(e){i("next",e)},function(e){i("throw",e)});e(d)}return i("next")})}}var o=n(9),s=(n.n(o),n(10)),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t.a={name:"DHPlayer",props:{videoId:{type:String,default:"1"},type:{type:Number,default:1},realTimeList:{type:Array,default:function(){return[]}},videoPlayList:{type:Array,default:function(){return[]}},pathList:{type:Array,default:function(){return[]}},windowType:{type:Number,default:0},num:{type:Number,default:1},connectTime:{type:Number,default:60},outContent:{type:Object,default:function(){return{top:0,left:0}}},downloadUrl:{type:String,default:"/download/DHPlayer.zip"},showBar:{type:Boolean,default:!0},noTip:{type:Boolean,default:!1},shieldClass:{type:Array,default:function(){return[]}},parentIframeShieldClass:{type:Array,default:function(){return[]}}},data:function(){return{videoPlayer:null,playbackList:[],DHPVisible:!1,DHPUrl:this.downloadUrl,DHPVersion:"",upgradeDHP:!1,api:Object(s.a)(this),currentWindow:0,divisionNum:4}},beforeDestroy:function(){this.destroy()},mounted:function(){this.initVideo()},methods:{destroy:function(){this.videoPlayer.destroy()},initVideo:function(){var e=this;this.videoPlayer&&this.destroy(),this.videoPlayer=new VideoPlayer({videoId:this.videoId,windowType:this.windowType,connectTime:this.connectTime,shieldClass:this.shieldClass,parentIframeShieldClass:this.parentIframeShieldClass,showBar:this.showBar,num:Math.pow(Math.ceil(Math.sqrt(this.pathList.length||(1===this.type?this.realTimeList.length:this.videoPlayList.length))),2)||this.num,outContent:this.outContent,connectSuccess:function(){e.DHPVersion=window.dhPlayerControl.DHPlayerVersion,e.getVideoInfo(!0)},snapshotSuccess:function(t){var n=t.base64Url,i=t.path;e.$emit("picCap",{base64Url:n,path:i})},switchStartTime:function(t){var n=t.startTime,i=t.snum,o=e.playbackList[i];if(o)if(o.request){var s=e.videoPlayList[i],r=s.endTime;if(n>r)return!e.noTip&&e.$message.warning("开始时间不得大于结束时间"),e.$emit("getError","开始时间不得大于结束时间"),!1;e.dealRecord(d({},s,{startTime:n}),i)}else{var a=e.getUrlParam(o.path,"endtime")-0;if(n>a)return!e.noTip&&e.$message.warning("开始时间不得大于结束时间"),e.$emit("getError","开始时间不得大于结束时间"),!1;e.setPlayback(d({},o,{playStartTime:n}),i)}e.$emit("switchStartTime",{startTime:n,snum:i})},replay:function(t){e.$emit("replay",t)},videoDownloadSuccess:function(t){!e.noTip&&e.$message.success("本地录像已存到 "+t),e.$emit("videoDownloadSuccess",t)},closeWindowSuccess:function(t){var n=t.isAll,i=t.snum;e.$emit("closeWindowSuccess",{isAll:n,snum:i})},getCurrentWindow:function(t){e.currentWindow=t,e.$emit("getCurrentWindow",t)},clickWindow:function(t){e.currentWindow=t,e.$emit("getCurrentWindow",t),console.log("当前点击了第"+t+"个窗口")},changeDivision:function(t){console.log(">>>"),e.divisionNum=t,e.$emit("changeDivision",t)},connectClose:function(){e.videoPlayer=null,e.getVideoInfo(!1)},createSuccess:function(t){e.showBar||e.setShowBar(!1),e.pathList.length?e.loadVideo():e.getRTSPURL()}})},getUrlParam:function(e,t){var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=e.match(n);return null!=i?unescape(i[2]):null},setShowBar:function(e){this.videoPlayer.showControlBar(e)},setOSDInfo:function(e){this.videoPlayer.setOSDInfo(e)},setDragEnable:function(e){this.videoPlayer.setWindowDragEnable({enable:e})},setFullScreen:function(){this.videoPlayer.setFullScreen()},loadVideo:function(){var e=this;if(1===this.type)this.pathList.forEach(function(t,n){var i={snum:n};if("string"==typeof t)i.path=t;else{if("object"!==(void 0===t?"undefined":r(t)))return t;i=d({},i,t)}e.setRealTime(i)});else{var t=[];this.pathList.forEach(function(n,i){t.push(d({},n,{request:!1})),e.setPlayback(n,i)}),this.playbackList=t}},getRTSPURL:function(){var e=this,t=1;1===this.type?(t=this.realTimeList.length>=4?2:1,this.realTimeList.forEach(function(n,i){e.api.fetchRealRTSP({data:{streamType:n.streamType||t,channelId:n.channelId,dataType:n.dataType||1}}).then(function(t){if(t.url){var o=e.dealUrl(t);e.setRealTime({path:o,redirect:n.redirect,snum:i})}})})):(t=this.videoPlayList.length>=4?2:1,this.videoPlayList.forEach(function(t,n){e.dealRecord(t,n)}))},dealRecord:function(e,t){var n=this;return i(regeneratorRuntime.mark(function i(){var o,s,r,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.api.fetchRecord({data:d({},e,{streamType:e.streamType||streamType})});case 2:if(o=i.sent,!o.records||!o.records.length){i.next=8;break}return i.next=6,n.api.fetchRTSP({data:d({},e,{streamType:e.streamType||streamType,dataType:e.dataType||1})});case 6:s=i.sent,s.url&&(r=n.dealUrl(s),a=d({},e,{path:r,redirect:"boolean"==typeof e.redirect?e.redirect:-1!==r.indexOf(":9090"),records:o.records}),n.setPlayback(a,t),n.playbackList[t]=d({},a,{request:!0}));case 8:case"end":return i.stop()}},i,n)}))()},setRealTime:function(e){this.videoPlayer.realmonitor(d({},e))},setPlayback:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.videoPlayer.playback({snum:t,records:e.records||[],path:e.url||e.path,startTime:e.startTime,endTime:e.endTime,redirect:e.redirect,playStartTime:e.playStartTime||e.startTime,playEndTime:e.playEndTime||e.endTime})},changeDivision:function(e){this.videoPlayer.changeDivision(e)},setTalk:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.videoPlayer.talk({snum:t,path:e.path,redirect:!1,audioType:e.audioType,audioBit:e.audioBit,sampleRate:e.sampleRate,talkType:1})},dealUrl:function(e){var t=e.url;return t=t.includes("|")?t.split("|").map(function(t){return t+"?token="+e.token}).reverse().join("|"):t+"?token="+e.token},hiddenDhp:function(){window.DHPVisible=this.DHPVisible=!1},hideWindow:function(e){this.videoPlayer.hide(e)},showWindow:function(e){this.videoPlayer.show(e)},windowShield:function(e){this.videoPlayer.windowShield(e)},getVideoInfo:function(e){var t=this;this.api.videoInfo().then(function(n){t.DHPUrl=n.url,n.version&&(n.version="000000"),e&&n.version>t.DHPVersion&&(t.upgradeDHP=!0,!window.DHPVisible&&(window.DHPVisible=t.DHPVisible=!0)),e||!window.DHPVisible&&(window.DHPVisible=t.DHPVisible=!0)}).catch(function(n){e||!window.DHPVisible&&(window.DHPVisible=t.DHPVisible=!0)})},downloadDhp:function(){window.location.href=this.DHPUrl,this.hiddenDhp()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.component(i.a.name,i.a)};"undefined"!=typeof window&&window.Vue&&o(window.Vue),i.a.install=o,t.default=i.a},function(e,t,n){"use strict";function i(e){n(3)}var o=n(0),s=n(11),r=n(8),d=i,a=r(o.a,s.a,!1,d,null,null);t.a=a.exports},function(e,t,n){var i=n(4);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n(6)("56d8be62",i,!0,{})},function(e,t,n){t=e.exports=n(5)(!1),t.push([e.i,".dh-video-modal{width:100%}.dh-video-modal .ant-modal-content{border:1px solid #ffa302;background:#fff7e9;color:#ffa302}.dh-video-modal .message{display:flex;align-items:center}.dh-video-modal .ant-modal-close-x{display:none}.dh-video-modal .ant-modal-body{padding:0 20px;font-size:14px;word-wrap:break-word;height:40px;line-height:40px;margin-left:0}.dh-video-modal .messageIcon{background:#ffa302;border-radius:50%;color:#fff;font-size:16px;margin-right:5px}.dh-video-modal .Modalcontent a{margin-left:15px}",""])},function(e,t){function n(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var s=i(o);return[n].concat(o.sources.map(function(e){return"/*# sourceURL="+o.sourceRoot+e+" */"})).concat([s]).join("\n")}return[n].join("\n")}function i(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var i=n(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},o=0;o<this.length;o++){var s=this[o][0];"number"==typeof s&&(i[s]=!0)}for(o=0;o<e.length;o++){var r=e[o];"number"==typeof r[0]&&i[r[0]]||(n&&!r[2]?r[2]=n:n&&(r[2]="("+r[2]+") and ("+n+")"),t.push(r))}},t}},function(e,t,n){function i(e){for(var t=0;t<e.length;t++){var n=e[t],i=h[n.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](n.parts[o]);for(;o<n.parts.length;o++)i.parts.push(s(n.parts[o]));i.parts.length>n.parts.length&&(i.parts.length=n.parts.length)}else{for(var r=[],o=0;o<n.parts.length;o++)r.push(s(n.parts[o]));h[n.id]={id:n.id,refs:1,parts:r}}}}function o(){var e=document.createElement("style");return e.type="text/css",c.appendChild(e),e}function s(e){var t,n,i=document.querySelector("style["+y+'~="'+e.id+'"]');if(i){if(f)return p;i.parentNode.removeChild(i)}if(g){var s=w++;i=u||(u=o()),t=r.bind(null,i,s,!1),n=r.bind(null,i,s,!0)}else i=o(),t=d.bind(null,i),n=function(){i.parentNode.removeChild(i)};return t(e),function(i){if(i){if(i.css===e.css&&i.media===e.media&&i.sourceMap===e.sourceMap)return;t(e=i)}else n()}}function r(e,t,n,i){var o=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=v(t,o);else{var s=document.createTextNode(o),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(s,r[t]):e.appendChild(s)}}function d(e,t){var n=t.css,i=t.media,o=t.sourceMap;if(i&&e.setAttribute("media",i),m.ssrId&&e.setAttribute(y,t.id),o&&(n+="\n/*# sourceURL="+o.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var a="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!a)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var l=n(7),h={},c=a&&(document.head||document.getElementsByTagName("head")[0]),u=null,w=0,f=!1,p=function(){},m=null,y="data-vue-ssr-id",g="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());e.exports=function(e,t,n,o){f=n,m=o||{};var s=l(e,t);return i(s),function(t){for(var n=[],o=0;o<s.length;o++){var r=s[o],d=h[r.id];d.refs--,n.push(d)}t?(s=l(e,t),i(s)):s=[];for(var o=0;o<n.length;o++){var d=n[o];if(0===d.refs){for(var a=0;a<d.parts.length;a++)d.parts[a]();delete h[d.id]}}}};var v=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t){e.exports=function(e,t){for(var n=[],i={},o=0;o<t.length;o++){var s=t[o],r=s[0],d=s[1],a=s[2],l=s[3],h={id:e+":"+o,css:d,media:a,sourceMap:l};i[r]?i[r].parts.push(h):n.push(i[r]={id:r,parts:[h]})}return n}},function(e,t){e.exports=function(e,t,n,i,o,s){var r,d=e=e||{},a=typeof e.default;"object"!==a&&"function"!==a||(r=e,d=e.default);var l="function"==typeof d?d.options:d;t&&(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0),n&&(l.functional=!0),o&&(l._scopeId=o);var h;if(s?(h=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},l._ssrRegister=h):i&&(h=i),h){var c=l.functional,u=c?l.render:l.beforeCreate;c?(l._injectStyles=h,l.render=function(e,t){return h.call(t),u(e,t)}):l.beforeCreate=u?[].concat(u,h):[h]}return{esModule:r,exports:d,options:l}}},function(e,t){function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}!function(){function e(){var e=this.setting.isPIframe?this.setting.topInnerWidth:window.top.innerWidth,t=this.setting.isPIframe?this.setting.topInnerHeight:window.top.innerHeight,n=i();return{width:e*n/100,height:t*n/100}}function t(e,t){var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=e.match(n);return null!=i?unescape(i[2]):null}function i(){var e=0,t=window.screen,n=navigator.userAgent.toLowerCase();return void 0!==window.devicePixelRatio?e=window.devicePixelRatio:~n.indexOf("msie")?t.deviceXDPI&&t.logicalXDPI&&(e=t.deviceXDPI/t.logicalXDPI):void 0!==window.outerWidth&&void 0!==window.innerWidth&&(e=window.outerWidth/window.innerWidth),e&&(e=Math.round(100*e)),e}function o(){var e=document.createElement("iframe");e.style.display="none",e.src="DHPlayer://",document.body.appendChild(e),setTimeout(function(){document.body.removeChild(e)},3e3)}function s(){var e=this;setTimeout(function(){sessionStorage.getItem("HikCentralWebControlPort")||(window.dhPlayerControl.wsConnect=!1,window.dhPlayerControl.windowState="wsFail",window.dhPlayerControl.noCardPlayerFlag=!0,e.setting.connectClose&&e.setting.connectClose())},1e3*e.setting.connectTime)}function r(){function e(e){window.dhPlayerControl.DHPlayerVersion=Number(e.data.ver);var t=sessionStorage.getItem("HikCentralWebControlPort");c["ws"+t].close(),p=!0,d()}function t(e){var t=3==e.target.url.split(":").length?e.target.url.split(":")[2].replace("/",""):"80",n={method:"common.version",info:{},id:w,session:window.dhPlayerControl.wsSession};c["ws"+t]&&1==c["ws"+t].readyState&&c["ws"+t].send(JSON.stringify(n))}function n(e){if(!window.dhPlayerControl.DHPlayerVersion)return void alert("插件未安装!");u++;var t=3==e.target.url.split(":").length?e.target.url.split(":")[2].replace("/",""):"80";c["ws"+t].close(),window.dhPlayerControl.noCardPlayerFlag||(f=f==h-1?0:f+1,s()),u==h&&(window.dhPlayerControl.openPlayerFlag||(window.dhPlayerControl.openPlayerFlag=!0,o()))}function i(t){var i=t&&t.data?JSON.parse(t.data):{};if(i.id==w){window.dhPlayerControl.openPlayerFlag=!0;var o=3==t.target.url.split(":").length?t.target.url.split(":")[2].replace("/",""):"80";sessionStorage&&sessionStorage.setItem("HikCentralWebControlPort",o),a[r[f]]=1,e(i)}else n(t)}function s(){c["ws"+r[f]]=new WebSocket("ws://localhost:"+r[f]),c["ws"+r[f]].onopen=t,c["ws"+r[f]].onerror=n,c["ws"+r[f]].onmessage=i}if(!window.dhPlayerControl.noCardPlayerFlag){if("undefined"==typeof WebSocket)return void alert("您的浏览器不支持socket");sessionStorage.getItem("HikCentralWebControlPort")&&sessionStorage.removeItem("HikCentralWebControlPort");for(var r=[],a={},l=8e3;l<=8004;l++)r.push(l);var h=r.length,c={},u=0,w=0,f=0,p=!1;window.dhPlayerControl.socketTimer&&window.clearTimeout(window.dhPlayerControl.socketTimer),window.dhPlayerControl.windowState="wsPending",s(),window.dhPlayerControl.socketTimer=setTimeout(function(){if(!p)for(var e=0,t=0;t<r.length;t++)1!=a[r[f]]&&e++,e==r.length&&(window.dhPlayerControl.openPlayerFlag||(window.dhPlayerControl.openPlayerFlag=!0,o()))},2e4)}}function d(){var e=sessionStorage.getItem("HikCentralWebControlPort");window.dhPlayerControl.videoWS=new WebSocket("ws:127.0.0.1:"+e),window.dhPlayerControl.videoWS.onopen=function(){window.dhPlayerControl.windowState="wsSuccess";for(var e in window.dhPlayerControl.videoList){var t=window.dhPlayerControl.videoList[e];t&&t.setting.connectSuccess(),t.create()}},window.dhPlayerControl.videoWS.onerror=d,window.dhPlayerControl.videoWS.onmessage=h}function a(e){for(var t=atob(e),n=t.length,i=new Uint8Array(n);n--;)i[n]=t.charCodeAt(n);return new Blob([i],{type:"image/jpeg"})}function l(e,t){var n=a(e);return URL.createObjectURL(n)}function h(e){if(null!=e.data&&""!=e.data){var t=JSON.parse(e.data);if(t.info){var n=window.dhPlayerControl.hwndList[t.info.hwnd];switch(t.method){case"web.seekRecord":n.switchStartTime&&n.switchStartTime({startTime:t.info.seekTime,snum:t.info.snum});break;case"web.replay":n.replay&&n.replay(t.info.snum);break;case"window.selected":n.snum=t.info.snum,n.getCurrentWindow&&n.getCurrentWindow(t.info.snum);break;case"video.close":n.snum=t.info.wndId,n.closeWindowSuccess&&n.closeWindowSuccess({isAll:t.info.isAll,snum:n.snum});break;case"talk.close":n.snum=t.info.wndId,n.closeTalkSuccess&&n.closeTalkSuccess({isAll:t.info.isAll,snum:n.snum});break;case"web.captureCallBack":var i=t.info.PicBuf?l(t.info.PicBuf):"";n.snapshotSuccess&&n.snapshotSuccess({base64Url:t.info.PicBuf,path:i});break;case"window.LocalRecordFinish":n.videoDownloadSuccess&&n.videoDownloadSuccess(t.info.path);break;case"video.window.clicked":n.clickWindow&&n.clickWindow(t.info.wndIndex);break;case"video.division.change":n.changeDivision&&n.changeDivision(t.info.division)}}var o=null,s=null;if(window.dhPlayerControl.callBackList[t.id]&&(o=window.dhPlayerControl.callBackList[t.id].onError,s=window.dhPlayerControl.callBackList[t.id].onSuccess),0!=t.code)return void(o&&"function"==typeof o&&(o(t),delete window.dhPlayerControl.callBackList[t.id]));window.dhPlayerControl.wsSession=t.session,s&&"function"==typeof s&&(s(t),delete window.dhPlayerControl.callBackList[t.id])}}function c(e,t){["window.change","window.shield"].includes(e.method)||console.log("web",JSON.stringify(e)),window.dhPlayerControl.videoWS&&1==window.dhPlayerControl.videoWS.readyState&&window.dhPlayerControl.videoWS.send(JSON.stringify(e))}function u(){window.dhPlayerControl.videoWS&&window.dhPlayerControl.videoWS.close(),window.dhPlayerControl.videoWS=null,window.wsHeart=clearInterval(window.wsHeart)}function w(){var e=function(){var e,t={},n=navigator.userAgent.toLowerCase();return(e=n.match(/edge\/([\d.]+)/))?t.edge=e[1]:(e=n.match(/rv:([\d.]+)\) like gecko/))?t.ie=e[1]:(e=n.match(/msie ([\d.]+)/))?t.ie=e[1]:(e=n.match(/firefox\/([\d.]+)/))?t.firefox=e[1]:(e=n.match(/chrome\/([\d.]+)/))?t.chrome=e[1]:(e=n.match(/opera.([\d.]+)/))?t.opera=e[1]:(e=n.match(/version\/([\d.]+).*safari/))&&(t.safari=e[1]),t.edge?{broswer:"Edge",version:t.edge}:t.ie?{broswer:"IE",version:t.ie}:t.firefox?{broswer:"Firefox",version:t.firefox}:t.chrome?{broswer:"Chrome",version:t.chrome}:t.opera?{broswer:"Opera",version:t.opera}:t.safari?{broswer:"Safari",version:t.safari}:{broswer:"",version:"0"}}();return"IE"==e.broswer?0:"Chrome"==e.broswer?1:"Firefox"==e.broswer?2:-1}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.document;if("hidden"==n.visibilityState)return!1;var i=null;if(i="class"===t?n.getElementsByClassName(e)[0]:n.getElementById(e),!e||!i)return"id"===t&&(this.setting.visible=!1),!1;var o=n.documentElement.clientWidth,s=n.documentElement.clientHeight,r=m.call(this,"id"===t?"":e),d=r.left,a=r.top,l=r.right,h=r.bottom;if(a>=s||h<=0||l<=0||d>=o)return"id"===t&&(this.setting.visible=!1),!1;for(var c=!0,u="none"!=getComputedStyle(i).display&&"hidden"!=getComputedStyle(i).visibility;c&&u;)i=i.parentNode,i&&i!=n.body?u="none"!=getComputedStyle(i).display&&"hidden"!=getComputedStyle(i).visibility:c=!1;return"id"===t&&(this.setting.visible=u),u}function p(e){return window.top.document.getElementsByClassName(e)[0].getBoundingClientRect()}function m(t){var n="",o=this.setting.videoId;if(!(n=t?document.getElementsByClassName(t)[0]:document.getElementById(o)))return{};var s,r=e.call(this),d=r.width,a=r.height,l=n.getBoundingClientRect(),h=i(),c=0,u=0,w=0,f=0;if(this.setting.isPIframe){s=this.setting.pIframeRect,f=s.width||this.setting.outContent.width,w=s.height||this.setting.outContent.height,c=s.left,u=s.top;var p=f+c-d,m=w+u-a;f=(f-p)*h/100,w=(w-m)*h/100}else{for(var y=window.parent.document.getElementsByTagName("iframe"),g=null,v=0;v<y.length;v++){if(t?y[v].contentWindow.document.getElementsByClassName(t)[0]:y[v].contentWindow.document.getElementById(o)){g=y[v];break}}if(g){s=g.getBoundingClientRect(),f=this.setting.outContent.width||s.width,w=this.setting.outContent.height||s.height,c=s.left,u=s.top;var p=f+c-d,m=w+u-a;f=(f-p)*h/100,w=(w-m)*h/100}}var C=l.left+(this.setting.outContent.left||c),P=l.top+(this.setting.outContent.top||u);return C=C*h/100,P=P*h/100,l.width=l.width*h/100,l.height=l.height*h/100,{left:C,top:P,right:C+l.width,bottom:P+l.height,outLeft:(this.setting.outContent.left||c)*h/100,outTop:(this.setting.outContent.top||u)*h/100,outWidth:f,outHeight:w,width:l.width,height:l.height}}window.dhPlayerControl=Object.assign({videoWS:null,wsConnectCount:0,wsSession:"",windowState:"",videoList:{},hwndList:{},callBackList:{},wsConnect:!1},window.dhPlayerControl||{},{socketTimer:null,openPlayerFlag:!1,noCardPlayerFlag:!1,DHPlayerVersion:""}),Function.prototype.myBind=function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return"bind"in Function.prototype?t.bind(e,n):function(){t.apply(e,n)}},document.getElementsByClassName||(document.getElementsByClassName=function(e,t){for(var n=(t||document).getElementsByTagName("*"),i=new Array,o=0;o<n.length;o++)for(var s=n[o],r=s.className.split(" "),d=0;d<r.length;d++)if(r[d]==e){i.push(s);break}return i});var y=function e(t){if(!t)throw new Error("请传入配置参数");if(!(this instanceof e))return new e(t);var n={isIE:!!window.ActiveXObject||"ActiveXObject"in window,videoId:"DHVideoPlayer",windowType:0,outContent:{left:0,right:0,width:0,height:0},show:!0,connectTime:60,connectSuccess:null,connectError:null,connectClose:null,option_id:{},heartCount:0,refreshTimer:null,browserType:1,isDestroy:!1,version:0,stopRefresh:!1,visible:!1,showBar:!0,hwnd:"",snum:0,mount:!0,num:1,isPIframe:!1,topInnerWidth:0,topInnerHeight:0,parentIframeShieldRect:[],pIframeRect:[]};if(this.setting=Object.assign({},n,t),n.isIE){var i=document.getElementById(this.setting.videoId);this.setting.ieDom=this.setting.videoId+"_box";var o=document.createElement("object");o.setAttribute("id",this.setting.ieDom),o.setAttribute("classid","clsid:1e68fa30-f1b5-4bbe-b483-8caaa2a3995a"),o.style.width="100%",o.style.height="100%",i.appendChild(o)}this.adjustCount=0,this.focus=!1,this.init()};y.fn=y.prototype={onbeforeunload:function(){this.destroy(),u()},send:function(e,t){t&&Object.keys(t).length&&(window.dhPlayerControl.callBackList[e.id]=t),this.setting.isIE?this.MainCall(e):c.call(this,e)},create:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{onSuccess:this.setting.createSuccess,onError:this.setting.createError},n=m.call(this),i=Object.assign({},{},n),o=e.call(this);i.num=this.setting.num,i.toolBar=this.setting.showBar?1:0,i.windowType=this.setting.windowType,i.browserType=this.setting.browserType,i.clientAreaHeight=o.height,i.clientAreaWidth=o.width,this.setTopBind=this.setTop.myBind(this),this.onbeforeunloadBind=this.onbeforeunload.myBind(this),this.visibilitychangeBind=this.setVisible.myBind(this);var s=this;this.send({method:"window.create",info:i,id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},{onSuccess:function(e){if(e.data&&null!=e.data.hwnd){var n=e.data.hwnd;s.setting.hwnd=n,window.dhPlayerControl.hwndList[n]=s.setting}window.addEventListener("beforeunload",s.onbeforeunloadBind),document.addEventListener("click",s.setTopBind),s.handleAdjust(),document.addEventListener("visibilitychange",s.visibilitychangeBind,!0),t.onSuccess&&t.onSuccess(e),s.show()},onError:function(){t.onError&&t.onError(data)}})},setVisible:function(){"hidden"==document.visibilityState?this.hide():f.call(this,this.setting.videoId)&&this.show()},setTop:function(){this.focus=!0,!this.setting.isDestroy&&this.browserFocusBlur()},browserFocusBlur:function(e,t){var n=this.extendOption(["hwnd","snum","show"],e);this.send({method:"browserFocusBlur",info:{hwnd:n.hwnd,browserType:this.setting.browserType,show:this.setting.show,focus:this.focus},session:window.dhPlayerControl.wsSession},t)},handleAdjust:function(){if(this.setting.isPIframe||!this.setting.stopRefresh&&!this.setting.isDestroy){var e=this;this.adjustCount%5?this.adjustCount++:(this.adjustCount=1,this.changePosition(),this.windowShield(this.cover())),this.setting.refreshTimer=window.requestAnimationFrame(function(){return e.handleAdjust()})}},destroy:function(e){var t=this.extendOption(["hwnd"]);this.send({method:"window.destroy",info:{hwnd:t.hwnd,browserType:this.setting.browserType},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},e),this.setting.isDestroy=!0,this.setting.isPIframe=!1,document.removeEventListener("click",this.setTopBind),document.removeEventListener("visibilitychange",this.visibilitychangeBind,!0),window.removeEventListener("beforeunload",this.onbeforeunloadBind)},setOSDInfo:function(e,t){var n=this.extendOption(["hwnd","snum"],e);this.send({method:"video.setOSDInfo",info:{hwnd:n.hwnd,snum:n.snum,R:n.R||255,G:n.G||255,B:n.B||255,fontSize:n.fontSize||14,positionX:n.positionX||1,positionY:n.positionY||1,osdInfo:n.osdInfo||"",fontWeight:n.fontWeight||0},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},t)},setWindowDragEnable:function(e,t){var n=this.extendOption(["hwnd"],e);this.send({method:"window.enableDrag",info:{hwnd:n.hwnd,enable:n.enable||!1},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},t)},setFullScreen:function(e,t){var n=this.extendOption(["hwnd"],e);this.send({method:"video.fullScreen",info:{hwnd:n.hwnd},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},t)},chooseWindow:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{onSuccess:this.setting.chooseWindowSuccess,onError:this.setting.chooseWindowError};this.send({method:"window.select",info:{hwnd:this.setting.hwnd,snum:e},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},t),this.windowShield(this.cover())},openAudio:function(e,t){var n=this.extendOption(["hwnd","snum"],e);this.send({method:"video.enableAudio",info:{hwnd:n.hwnd,snum:n.snum,isEnable:n.isEnable,videoType:n.videoType,browserType:this.setting.browserType},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},t)},realmonitor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{onSuccess:this.setting.realTimeSuccess,onError:this.setting.realTimeError},n=this.extendOption(["hwnd","snum"],e),i={};i.hwnd=n.hwnd,i.snum=n.snum,i.path=n.path,i.browserType=this.setting.browserType,i.redirect="boolean"!=typeof n.redirect||n.redirect,this.send({method:"video.realmonitor",info:i,id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},t),this.windowShield(this.cover())},talk:function(e,t){var n=this.extendOption(["hwnd","snum"],e);n.browserType=this.setting.browserType,this.send({method:"video.starttalk",info:n,id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},t),this.windowShield(this.cover())},playback:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{onSuccess:this.setting.playbackSuccess,onError:this.setting.playbackError},i=this.extendOption(["hwnd","snum"],e),o={};if(o.hwnd=i.hwnd,o.snum=i.snum,o.path=i.path,o.records=i.records,o.startTime=i.startTime,o.endTime=i.endTime,o.playStartTime=i.playStartTime,o.playEndTime=i.playEndTime,o.browserType=this.setting.browserType,o.redirect="boolean"!=typeof i.redirect||i.redirect,i.playStartTime){var s=t(o.path,"begintime");o.path=o.path.replace(s,i.playStartTime)}this.send({method:"video.playback",info:o,id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},n),this.windowShield(this.cover())},changePosition:function(t,n){var i=this.extendOption(["hwnd"],t),o=e.call(this),s=m.call(this),r=Object.assign({},{},s,i);r.browserType=this.setting.browserType,r.clientAreaHeight=o.height,r.clientAreaWidth=o.width,r.screenX=window.screenX,r.screenY=window.screenY,r.show=f.call(this,this.setting.videoId),this.send({method:"window.change",info:r,session:window.dhPlayerControl.wsSession},n)},hide:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{onSuccess:this.setting.hideWindowSuccess,onError:this.setting.hideWindowError},t=this.extendOption(["hwnd"]);this.setting.show=!1,this.setting.stopRefresh=!0,this.send({method:"window.show",info:{hwnd:t.hwnd,show:!1,browserType:this.setting.browserType},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},e)},show:function(){var e=this,t=this.extendOption(["hwnd"]);this.setting.stopRefresh=!1,this.setting.show=!0,this.send({method:"window.show",info:{hwnd:t.hwnd,show:!0,browserType:this.setting.browserType},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},{onSuccess:function(){e.setting.refreshTimer&&window.cancelAnimationFrame(e.setting.refreshTimer),e.handleAdjust(),e.setting.showWindowSuccess&&e.setting.showWindowSuccess()},onError:this.setting.showWindowError})},closeVideo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{onSuccess:this.setting.closeVideoSuccess,onError:this.setting.closeVideoError},n=this.extendOption(["hwnd","snum"],e);this.send({method:"video.close",info:{hwnd:n.hwnd,snum:n.snum,isAll:e.isAll},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},t)},closeTalk:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{onSuccess:this.setting.closeTalkSuccess,onError:this.setting.closeTalkError},n=this.extendOption(["hwnd","snum"],e);this.send({method:"video.closetalk",info:{hwnd:n.hwnd,snum:n.snum,isAll:e.isAll},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},t)},controlPlayback:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{onSuccess:this.setting.controlPlaybackSuccess,onError:this.setting.controlPlaybackError},n=this.extendOption(["hwnd","snum"],e);this.send({method:"video.playbackChangeState",info:{hwnd:n.hwnd,snum:n.snum,state:e.state},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},t)},showControlBar:function(e){var t=this.extendOption(["hwnd"]);this.send({method:"video.setToolBarShow",info:{hwnd:t.hwnd,isShow:e?1:0,browserType:this.setting.browserType},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession})},localRecordDownload:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{onSuccess:this.setting.recordDownloadSuccess,onError:this.setting.recordDownloadError};this.send({method:"vidoe.localRecord",info:{hwnd:this.setting.hwnd,snum:e},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},t)},changeDivision:function(e){var t=this.extendOption(["hwnd"]);this.send({method:"video.division.change",info:{hwnd:t.hwnd,browserType:this.setting.browserType,division:e},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession})},snapshot:function(e){this.send({method:"video.snapic",info:{hwnd:this.setting.hwnd,snum:e},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession})},windowShield:function(t,n){var i=this.extendOption(["hwnd"],t),o=e.call(this),s={};s.hwnd=i.hwnd,s.browserType=this.setting.browserType,s.region=this.getShieldRect(t),s.clientAreaHeight=o.height,s.clientAreaWidth=o.width,this.send({method:"window.shield",info:s,id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},n)},version:function(e){this.send({method:"common.version",info:{},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},e)},getWindowState:function(e){var t=this.extendOption(["hwnd"]);this.send({method:"window.getWindowState",info:{hwnd:t.hwnd},id:window.dhPlayerControl.wsConnectCount++,session:window.dhPlayerControl.wsSession},e)},cover:function(){var t,n,i,o,s=m.call(this),r=e.call(this),d=s.left,a=s.top,l=s.right,h=s.bottom+1,c=s.width,u=s.height,w=s.outLeft,f=s.outTop,p=s.outWidth,y=s.outHeight,g=[];d<w&&(t=w-d,g.push(d,a,t,u)),a<f&&(n=f-a,g.push(d,a,c,n));var v=p+w||r.width,C=y+f||r.height;return v-l<0&&(i=v,t=l-i,g.push(i,a,t,u)),C-h<0&&(n=h-C,g.push(d,C,c,n)),v-l<0&&C-h<0&&(t=l-i,n=h-C,g.push(v,C,t,n)),d<0&&a<0&&(t=Math.abs(d),n=Math.abs(a),g.push(d,a,t,n)),v-l<0&&a<0&&(i=v,t=l-i,n=-a,g.push(i,a,t,n)),d<0&&C-h<0&&(o=C,t=-d,n=h-o,g.push(d,o,t,n)),g},extendOption:function(e,t){for(var n={},i=0;i<e.length;i++)n[e[i]]=this.setting[e[i]];return Object.assign({},n,t)},getShieldRect:function(e){for(var t,i=this.setting.shieldClass||[],o=e||[],s=0;s<i.length;s++)f.call(this,i[s],"class")&&(t=m.call(this,i[s]),o.push(t.left,t.top,t.width,t.height));if(this.setting.isPIframe)o.push.apply(o,n(this.getIframeShieldRect()));else{var r=this.setting.parentIframeShieldClass||[];for(s=0;s<r.length;s++)f.call(this,r[s],"class",window.document)&&(t=p.call(this,r[s]),o.push(t.left,t.top,t.width,t.height))}return o},getIframeShieldRect:function(){var e=this;addEventListener("message",function(t){"shieldRect"==t.data.methods&&(e.setting.parentIframeShieldRect=t.data.parentIframeShieldRect)});var t=this.setting.parentIframeShieldRect;return[t.left,t.top,t.width,t.height]},getOsInfo:function(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("win")>-1?e.indexOf("windows nt 5.0")>-1||e.indexOf("Windows 2000")>-1?"Windows 2000":e.indexOf("windows nt 5.1")>-1||e.indexOf("Windows XP")>-1?"Windows XP":e.indexOf("windows nt 5.2")>-1||e.indexOf("Windows 2003")>-1?"Windows 2003":e.indexOf("windows nt 6.0")>-1||e.indexOf("Windows Vista")>-1?"Windows Vista":e.indexOf("windows nt 6.1")>-1||e.indexOf("windows 7")>-1?"Windows 7":e.indexOf("windows nt 6.2")>-1||e.indexOf("windows 8")>-1?"Windows 8":e.indexOf("windows nt 6.3")>-1?"Windows 8.1":e.indexOf("windows nt 6.4")>-1||e.indexOf("windows nt 10")>-1?"Windows 10":"Unknown":e.indexOf("iphone")>-1?"Iphone":e.indexOf("mac")>-1?"Mac":e.indexOf("x11")>-1||e.indexOf("unix")>-1||e.indexOf("sunname")>-1||e.indexOf("bsd")>-1?"Unix":e.indexOf("linux")>-1?e.indexOf("android")>-1?"Android":"Linux":"Unknown"},initConnect:function(){this.setting.connectSuccess(),this.create()},MainCall:function(e){var t=document.getElementById(this.setting.ieDom);if("common.heartbeat"==e.method){if(++this.setting.heartCount>=3)return t=null,void this.setting.connectClose()}else this.setting.option_id[e.id]=e;t&&t.MainCall(e.method,JSON.stringify(e))},init:function(){var e=this;addEventListener("message",function(t){t.data.isPIframe&&(e.setting.topInnerWidth=t.data.topInnerWidth,e.setting.topInnerHeight=t.data.topInnerHeight,e.setting.parentIframeShieldRect=t.data.parentIframeShieldRect,e.setting.pIframeRect=t.data.pIframeRect,e.setting.isPIframe||(e.destroy(),setTimeout(function(){e.setting.isPIframe=t.data.isPIframe,e.initPlayer(),console.log("初始化控件！")},3e3)))}),this.initPlayer()},initPlayer:function(){var e=this;this.setting.isIE?this.initConnect():window.dhPlayerControl.wsConnect?"wsSuccess"===window.dhPlayerControl.windowState?(this.setting.connectSuccess&&this.setting.connectSuccess(),e.create()):window.dhPlayerControl.videoList[e.setting.videoId]=this:(window.dhPlayerControl.wsConnect=!0,window.dhPlayerControl.videoList[e.setting.videoId]=this,r.call(e),s.call(e)),this.setting.browserType=w()}},window.VideoPlayer=window.VideoPlayer||y}()},function(e,t,n){"use strict";t.a=function(e){return{videoInfo:function(){var t=e.resetAjax||function(){};return new Promise(function(e,n){t({method:"get",url:"evo-brm/1.2.0/resources-info/get-resource?category=1&type=DHPlayer",isNoLock:!0,isSNoTip:!0,jumpLogin:!0,onSuccess:function(t){e(t.data.data)},onError:function(e){n(e)}})})},fetchRealRTSP:function(t){var n=e.resetAjax||function(){};return new Promise(function(e,i){n({method:"post",url:"admin/API/MTS/Video/StartVideo",isSNoTip:!0,jumpLogin:!0,data:t,onSuccess:function(t){e(t.data.data)},onError:function(e){i(e)}})})},fetchRTSP:function(t){var n=e.resetAjax||function(){};return new Promise(function(e,i){n({method:"post",url:"admin/API/SS/Playback/StartPlaybackByTime",isSNoTip:!0,data:t,onSuccess:function(t){e(t.data.data)},onError:function(e){i(e)}})})},fetchRecord:function(t){var n=e.resetAjax||function(){};return new Promise(function(e,i){n({method:"post",url:"admin/API/SS/Record/QueryRecords",isSNoTip:!0,data:t,onSuccess:function(t){e(t.data.data)},onError:function(e){i(e)}})})}}}},function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{attrs:{id:e.videoId}}),e._v(" "),e.noTip?e._e():n("div",[n("a-modal",{staticClass:"dh-video-modal",attrs:{footer:null,mask:!1,width:"280px"},model:{value:e.DHPVisible,callback:function(t){e.DHPVisible=t},expression:"DHPVisible"}},[n("div",{staticClass:"message"},[n("a-icon",{staticClass:"messageIcon",attrs:{type:"exclamation"}}),e._v(" "),n("div",{staticClass:"Modalcontent"},[e.upgradeDHP?n("span",[e._v("视频插件已更新了~")]):n("span",[e._v("系统未检测到视频插件")]),e._v(" "),n("a",{attrs:{href:"#"},on:{click:e.downloadDhp}},[e.upgradeDHP?n("span",[e._v("更新插件")]):n("span",[e._v("下载插件")])])])],1)])],1)])},o=[],s={render:i,staticRenderFns:o};t.a=s}])});
//# sourceMappingURL=DHPlayer.js.map